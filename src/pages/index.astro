---
import Layout from "../layouts/Layout.astro";
import HomeWorkspace from "@/components/HomeWorkspace";
import { getDb } from "../lib/db";
import { getPublishedTasks } from "../lib/articles/service";

const db = getDb(Astro.locals);
const publishedTasks = await getPublishedTasks(db);

const publishedDays = Array.from(
	new Set(publishedTasks.map((t) => t.taskDate)),
).sort();
const initialDate = new Date().toISOString().split("T")[0];
---

<Layout
	title="Daily Vocabulary Reader"
	mainClass="p-0 max-w-none overflow-hidden"
>
	<HomeWorkspace
		client:load
		publishedDays={publishedDays}
		initialDate={initialDate}
	/>
</Layout>
